{% extends "base.html" %}

{% block content %}
<div class="row g-4">
    <!-- Lap Time Chart -->
    <div class="col-12">
        <div class="card bg-secondary">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="bi bi-graph-up me-2"></i>Rundenzeiten-Analyse
                </h5>
            </div>
            <div class="card-body">
                <canvas id="lapTimesChart" height="100"></canvas>
            </div>
        </div>
    </div>

    <!-- Statistics Cards -->
    <div class="col-md-3">
        <div class="card bg-secondary text-center">
            <div class="card-body">
                <i class="bi bi-trophy-fill text-warning fs-1"></i>
                <h5 class="mt-3">Beste Rundenzeit</h5>
                <h3 class="text-success" id="bestLapTime">--:--.---</h3>
                <small class="text-muted" id="bestLapDriver">---</small>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card bg-secondary text-center">
            <div class="card-body">
                <i class="bi bi-speedometer2 text-info fs-1"></i>
                <h5 class="mt-3">Durchschnittszeit</h5>
                <h3 class="text-info" id="avgLapTime">--:--.---</h3>
                <small class="text-muted">Alle Fahrer</small>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card bg-secondary text-center">
            <div class="card-body">
                <i class="bi bi-flag-fill text-success fs-1"></i>
                <h5 class="mt-3">Gesamte Runden</h5>
                <h3 class="text-warning" id="totalRounds">---</h3>
                <small class="text-muted">Alle Fahrer</small>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card bg-secondary text-center">
            <div class="card-body">
                <i class="bi bi-people-fill text-primary fs-1"></i>
                <h5 class="mt-3">Aktive Fahrer</h5>
                <h3 class="text-primary" id="activeDrivers">---</h3>
                <small class="text-muted">Im Rennen</small>
            </div>
        </div>
    </div>

    <!-- Driver Comparison -->
    <div class="col-12">
        <div class="card bg-secondary">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="bi bi-bar-chart me-2"></i>Fahrer-Vergleich
                </h5>
            </div>
            <div class="card-body">
                <canvas id="driverComparisonChart" height="100"></canvas>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
let lapTimesChart, driverComparisonChart;

document.addEventListener('DOMContentLoaded', function() {
    initializeAnalysisCharts();
});

function initializeAnalysisCharts() {
    // Lap Times Chart
    const ctx1 = document.getElementById('lapTimesChart').getContext('2d');
    lapTimesChart = new Chart(ctx1, {
        type: 'line',
        data: {
            labels: [],
            datasets: []
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    labels: { color: '#fff' }
                }
            },
            scales: {
                x: { 
                    ticks: { color: '#fff' },
                    grid: { color: '#444' }
                },
                y: { 
                    ticks: { color: '#fff' },
                    grid: { color: '#444' }
                }
            }
        }
    });

    // Driver Comparison Chart
    const ctx2 = document.getElementById('driverComparisonChart').getContext('2d');
    driverComparisonChart = new Chart(ctx2, {
        type: 'bar',
        data: {
            labels: [],
            datasets: [{
                label: 'Beste Rundenzeit (ms)',
                data: [],
                backgroundColor: ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#ffeaa7', '#dda0dd', '#98d8c8']
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    labels: { color: '#fff' }
                }
            },
            scales: {
                x: { 
                    ticks: { color: '#fff' },
                    grid: { color: '#444' }
                },
                y: { 
                    ticks: { color: '#fff' },
                    grid: { color: '#444' }
                }
            }
        }
    });
}
</script>
{% endblock %}
